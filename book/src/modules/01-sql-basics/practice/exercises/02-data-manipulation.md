# Практика: Манипуляция данными (DML и JOIN)

В этой секции мы будем наполнять наши таблицы данными и извлекать их с помощью `JOIN`. Убедитесь, что вы успешно выполнили предыдущие упражнения по DDL.

## Упражнение 1: Наполнение таблиц

Заполните таблицы `categories` и `products` начальными данными.

**Задачи:**
1.  Добавьте категории: "Электроника", "Книги", "Бытовая техника".
2.  Добавьте подкатегорию "Смартфоны" для "Электроники".
3.  Добавьте три продукта:
    *   Смартфон "Pixel 8" по цене 70000 с артикулом "P8-128".
    *   Книгу "Чистый код" по цене 1200 с артикулом "CL-CODE".
    *   Холодильник "Атлант" по цене 45000 с артикулом "ATL-200".
4.  Свяжите "Pixel 8" с категориями "Электроника" и "Смартфоны".
5.  Свяжите "Чистый код" с категорией "Книги".

```sql,editable
-- 1. Добавляем категории
INSERT INTO categories ...

-- 2. Добавляем подкатегорию
-- (Сначала нужно узнать id "Электроники")


-- 3. Добавляем продукты


-- 4, 5. Связываем продукты и категории

```

## Упражнение 2: `INNER JOIN`

Напишите запрос, который выводит **только те** продукты, которые состоят хотя бы в одной категории.

**Требуемые поля:**
*   `products.name` (название продукта)
*   `products.price` (цена)
*   `categories.name` (название категории)

```sql,editable
-- Ваш код здесь

```

## Упражнение 3: `LEFT JOIN`

Напишите запрос, который выводит **все** продукты и их категории. Если у продукта нет категории, поле категории должно содержать `NULL`.

**Требуемые поля:**
*   `products.name` (название продукта)
*   `categories.name` (название категории)

**Задача со звездочкой:** Отсортируйте результат так, чтобы продукты без категорий шли первыми.

```sql,editable
-- Ваш код здесь

```

## Упражнение 4: `RIGHT JOIN` и агрегация

Напишите запрос, который выводит **все** категории и количество продуктов в каждой из них. Категории без продуктов тоже должны быть в списке с количеством `0`.

**Требуемые поля:**
*   `categories.name` (название категории)
*   `product_count` (рассчитанное поле количества продуктов)

**Подсказка:** Используйте `COUNT(products.id)` и `GROUP BY`.

```sql,editable
-- Ваш код здесь

```

## Упражнение 5: Self-Join (соединение с собой)

Выведите все категории, у которых есть родительская категория.

**Требуемые поля:**
*   `child_name` (имя дочерней категории)
*   `parent_name` (имя родительской категории)

**Подсказка:** Вам нужно будет соединить таблицу `categories` саму с собой, используя псевдонимы, например `c1` и `c2`.

```sql,editable
-- Ваш код здесь

``` 